# MF-BAM: ê²½ëŸ‰í™”ëœ ë¹„ì„ í˜• ê³¼ì œ í•™ìŠµìš© ì–‘ë°©í–¥ ì—°ìƒ ë©”ëª¨ë¦¬
[![Python 3.9+](https://img.shields.io/badge/python-3.9+-blue.svg)](https://www.python.org/downloads/release/python-390/)
[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)

ì´ í”„ë¡œì íŠ¸ëŠ” "A multilayered bidirectional associative memory model for learning nonlinear tasks" (Rolon-MÃ©rette et al., 2023) ë…¼ë¬¸ì—ì„œ ì œì•ˆëœ **MF-BAM (Multi-Feature extraction Bidirectional Associative Memory)** ëª¨ë¸ì„ NumPy ê¸°ë°˜ìœ¼ë¡œ ê°€ë³ê²Œ êµ¬í˜„í•œ ê²ƒì…ë‹ˆë‹¤.

PyTorch, TensorFlowì™€ ê°™ì€ ë¬´ê±°ìš´ ë”¥ëŸ¬ë‹ í”„ë ˆì„ì›Œí¬ ì—†ì´, ìˆœìˆ˜ Pythonê³¼ NumPyë§Œìœ¼ë¡œ êµ¬í˜„í•˜ì—¬ **ì €ì‚¬ì–‘ í™˜ê²½ìœ¼ë¡œì˜ ì´ì‹ì„±**ì„ ì—¼ë‘ì— ë‘ê³  ì„¤ê³„ë˜ì—ˆìŠµë‹ˆë‹¤.

ì‹¤ì œ ì ìš©ëœ í”„ë¡œì íŠ¸(LoRa e22 ëª¨ë“ˆ LLNs í™˜ê²½ì—ì„œì˜ ì‹¤í—˜)
https://github.com/4xvgal/ChirpChirp
> **ë” ìì„¸í•œ ì‹¤í—˜ ê³¼ì •ê³¼ ë°ì´í„° ë¶„ì„ ë‚´ìš©ì€ ì—ì„œ í™•ì¸í•˜ì‹¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤.**


## ğŸŒŸ ì£¼ìš” ì‘ìš© ì‚¬ë¡€: LoRa í†µì‹  ì„±ëŠ¥ ê°œì„  í”„ë¡œì íŠ¸

ì´ MF-BAM ëª¨ë¸ì€ **ë¶ˆì•ˆì •í•œ ì €ì „ë ¥ í†µì‹  í™˜ê²½(LLN)ì—ì„œ ë°ì´í„° ì „ì†¡ë¥ ì„ ë†’ì´ëŠ” í”„ë¡œì íŠ¸**ì— ì„±ê³µì ìœ¼ë¡œ ì ìš©ë˜ì—ˆìŠµë‹ˆë‹¤. ê²½ëŸ‰ ì••ì¶•ê¸°ë¡œì„œì˜ ì„±ëŠ¥ì€ ì•„ë˜ì™€ ê°™ìŠµë‹ˆë‹¤.
(ì••ì¶•ë¥ : 32B -> 20B 62.5%)
| êµ¬ë¶„ | ê°’ | ë¹„ê³  |
|---|---|---|
| **ë³µì› ì˜¤ì°¨ (MSE)** | **0.003619** | ì›ë³¸ ì •ë³´ ì†ì‹¤ ìµœì†Œí™” |
| **ì••ì¶• ë¹„ìœ¨** | **1.5 : 1** | 12 í”¼ì²˜ â†’ 8 ì ì¬ ë²¡í„° |

<br>
<p align="center">
  <br>
</p>

> **â¡ï¸ [LoRa í†µì‹  ê°œì„  í”„ë¡œì íŠ¸ ì „ì²´ ë‚´ìš© ë³´ê¸° (GitHub: 4xvgal/ChirpChirp)](https://github.com/4xvgal/ChirpChirp)**
> 
> **â¡ï¸ [LoRa_í†µì‹ ê°œì„ _í”„ë¡œì íŠ¸_ìµœì¢…ë³´ê³ ì„œ.pdf](https://github.com/user-attachments/files/21096150/LoRa_._._.pdf)**  <!-- "https://..." ë¶€ë¶„ì„ ë‹˜ì˜ PDF íŒŒì¼ ë§í¬ URLë¡œ êµì²´í•˜ì„¸ìš” -->
> <br>
> (ì‹¤ì œ í•„ë“œ í…ŒìŠ¤íŠ¸ ì‚¬ì§„, í•˜ë“œì›¨ì–´ êµ¬ì„± ë“±ì€ ìœ„ GitHub ë§í¬ ë˜ëŠ” ë³´ê³ ì„œì—ì„œ í™•ì¸í•˜ì‹¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤.)

---


*ì‹¤ì œ í†µì‹  ë°ì´í„°ì— ëŒ€í•œ ì••ì¶• -> ë³µì› ê²°ê³¼
![Final bset](https://github.com/user-attachments/assets/4cc89d83-8910-4856-9a12-08cc1973a969)


## ğŸ“ˆ ë°ì´í„° ì••ì¶•Â·ë³µì› ì„±ëŠ¥ ìš”ì•½

### âœ… ì „ì²´ í…ŒìŠ¤íŠ¸ì…‹ ë³µì› ì˜¤ì°¨  
- **Mean Squared Error (MSE)**: **0.003619**  


### ğŸ“¦ ì••ì¶• ë¹„ìœ¨  
- **ì…ë ¥ í”¼ì²˜**: 12 ê°œ  
- **ì ì¬ ë²¡í„°**: 8 ê°œ  
- **Compression ratio**: **1.5 : 1**

---

### ğŸ” ë‹¨ì¼ ìƒ˜í”Œ ìƒì„¸ ë¹„êµ

#### ì „ì†¡ë  ì ì¬ ë²¡í„°  
`[0.0168, 0.1664, -0.6171, 0.1189, -0.4530, 0.8912, -0.1595, -0.2937]`

| Feature | Original | Reconstructed | |Absolute&nbsp;Error|
|---|---:|---:|---|---:|
| decoded_accel_ax | **0.9130** | **0.8961** | âœ”ï¸ | 0.0169 |
| decoded_accel_ay | -0.2010 | -0.1818 | âœ”ï¸ | 0.0192 |
| decoded_accel_az | 0.4000 | 0.3997 | âœ”ï¸ | 0.0003 |
| decoded_gyro_gx | 0.0000 | -0.6075 | âœ”ï¸ | 0.6075 |
| decoded_gyro_gy | 0.0000 | -1.0846 | âš ï¸ | 1.0846 |
| decoded_gyro_gz | 0.0000 | 1.3382 | âš ï¸ | 1.3382 |
| decoded_angle_roll | -26.7000 | -25.7422 | âœ”ï¸ | 0.9578 |
| decoded_angle_pitch | -63.8000 | -62.7246 | âš ï¸ | 1.0754 |
| decoded_angle_yaw | -29.8000 | -31.1870 | âš ï¸ | 1.3870 |
| decoded_gps_lat | 0.1477 | 0.1416 | âœ”ï¸ | 0.0061 |
| decoded_gps_lon | 0.0269 | 0.0296 | âœ”ï¸ | 0.0027 |
| decoded_gps_altitude | 84.7000 | 77.2924 | âš ï¸ | 7.4076 |

> **ì°¸ê³ **  
> - âœ”ï¸ : ì ˆëŒ€ ì˜¤ì°¨ â‰¤ 1.0 (í—ˆìš© ë²”ìœ„)  
> - âš ï¸ : ì ˆëŒ€ ì˜¤ì°¨ > 1.0 (ì¶”ê°€ ê°œì„  í•„ìš”)

---

### âœ¨ ì¸ì‚¬ì´íŠ¸
- **í‰ê·  MSE 0.0036** ìœ¼ë¡œ, ì „ì²´ì ìœ¼ë¡œ ìš°ìˆ˜í•œ ë³µì› ì„±ëŠ¥ì„ ìœ ì§€í•˜ê³  ìˆìŠµë‹ˆë‹¤.    
- ê°€ì†ë„ ë° GPS ìœ„ì¹˜ ê°’ì€ ê±°ì˜ ì™„ë²½í•˜ê²Œ ë³µì›ë˜ì–´, **ìœ„ì¹˜Â·ê°€ì† ì •ë³´ ì „ì†¡ ì‹ ë¢°ë„**ê°€ ë†’ìŒì„ í™•ì¸í–ˆìŠµë‹ˆë‹¤.


## âœ¨ ì£¼ìš” íŠ¹ì§•

- **ğŸ§  ì¸ì§€ê³¼í•™ ê¸°ë°˜ ì•„í‚¤í…ì²˜**: ì¸ê°„ì˜ ë‡Œê°€ ì •ë³´ë¥¼ ì²˜ë¦¬í•˜ëŠ” ë°©ì‹ì— ì˜ê°ì„ ë°›ì€ 2ë‹¨ê³„ ëª¨ë“ˆ(ë¹„ì§€ë„ íŠ¹ì„± ì¶”ì¶œ + ì§€ë„ ì—°ê´€ í•™ìŠµ) êµ¬ì¡°ë¥¼ ê°€ì§‘ë‹ˆë‹¤.
- **âš™ï¸ í”„ë ˆì„ì›Œí¬ ë…ë¦½**: ì™¸ë¶€ ë”¥ëŸ¬ë‹ ë¼ì´ë¸ŒëŸ¬ë¦¬ ì˜ì¡´ì„± ì—†ì´ NumPyë¡œë§Œ í•µì‹¬ ë¡œì§ì´ êµ¬í˜„ë˜ì–´ ìˆì–´ ë§¤ìš° ê°€ë³ê³  ì´í•´í•˜ê¸° ì‰½ìŠµë‹ˆë‹¤.
- **ğŸš€ 2ë‹¨ê³„ í•™ìŠµ íŒŒì´í”„ë¼ì¸**:
  1. **ë¹„ì§€ë„ íŠ¹ì„± ì¶”ì¶œ**: ì…ë ¥ ë°ì´í„°ì˜ ë³¸ì§ˆì ì¸ íŠ¹ì„±ì„ ì ì§„ì ìœ¼ë¡œ í•™ìŠµí•©ë‹ˆë‹¤.
  2. **ì§€ë„ ì—°ê´€ í•™ìŠµ**: ì¶”ì¶œëœ íŠ¹ì„±ê³¼ ëª©í‘œ ë ˆì´ë¸”ì„ ì–‘ë°©í–¥ìœ¼ë¡œ ì—°ê²°í•©ë‹ˆë‹¤.
- **â†”ï¸ ì–‘ë°©í–¥ ë©”ëª¨ë¦¬**:
  - **ìˆœë°©í–¥ (x â†’ y')**: ì…ë ¥ì— ëŒ€í•œ ë¶„ë¥˜(Classification)ë¥¼ ìˆ˜í–‰í•©ë‹ˆë‹¤.
  - **ì—­ë°©í–¥ (y â†’ x')**: íŠ¹ì • í´ë˜ìŠ¤ì˜ ì „í˜•ì ì¸(prototypical) ì…ë ¥ íŒ¨í„´ì„ ë³µì›/ì—°ìƒí•©ë‹ˆë‹¤.
  - **ì˜¤í„°ì¸ì½”ë” ì—­í• **: MF-BAMì˜ ì–‘ë°©í–¥ êµ¬ì¡°ë¥¼ í™œìš©í•´ ì˜¤í† ì¸ì½”ë”ì™€ ë™ì¼í•œ ê¸°ëŠ¥(ë°ì´í„° ì••ì¶• ë° ë³µì›)ì„ ìˆ˜í–‰í•˜ë„ë¡ ëª¨ë¸ì„ ì„¤ê³„

## ğŸ›ï¸ í”„ë¡œì íŠ¸ ì•„í‚¤í…ì²˜

ëª¨ë¸ì€ ë‘ ê°€ì§€ ì£¼ìš” ëª¨ë“ˆì´ ìˆœì°¨ì ìœ¼ë¡œ ì—°ê²°ëœ êµ¬ì¡°ì…ë‹ˆë‹¤.

**`Original Data (p)`** â¡ï¸ **`[Feature Extractor (MF) Module]`** â¡ï¸ **`Features (h_l)`** â¡ï¸ **`[Supervised Layer (SL) Module]`** â¡ï¸ **`Target (o)`**

1. **Feature Extractor (MF) Module**: ì—¬ëŸ¬ ê°œì˜ `UnsupervisedLayer` (UL)ê°€ ìŒ“ì—¬ìˆëŠ” êµ¬ì¡°ì…ë‹ˆë‹¤. ê° ULì€ ì…ë ¥ì˜ ì¬êµ¬ì„±ì„ ëª©í‘œë¡œ í•˜ëŠ” ë¹„ì§€ë„ í•™ìŠµì„ í†µí•´ ë°ì´í„°ì˜ ì ì§„ì ì´ê³  ê¹Šì€ íŠ¹ì„±ì„ ì¶”ì¶œí•©ë‹ˆë‹¤.
2. **Supervised Layer (SL) Module**: MF ëª¨ë“ˆì´ ì¶”ì¶œí•œ ìµœì¢… íŠ¹ì„±(`h_l`)ê³¼ ì‹¤ì œ ì •ë‹µ ë ˆì´ë¸”(`o`)ì„ ì…ë ¥ìœ¼ë¡œ ë°›ì•„, ë‘˜ ì‚¬ì´ì˜ ì—°ê´€ ê´€ê³„ë¥¼ í•™ìŠµí•˜ëŠ” ì–‘ë°©í–¥ ì—°ìƒ ë©”ëª¨ë¦¬(BAM)ì…ë‹ˆë‹¤.

## ğŸ“ í´ë” êµ¬ì¡°

```
BAM_COMPRESSOR/
â”œâ”€â”€ .venv/                  # ê°€ìƒ í™˜ê²½
â”œâ”€â”€ bam_compressor/         # ë©”ì¸ ì†ŒìŠ¤ íŒ¨í‚¤ì§€
â”‚   â”œâ”€â”€ data/
â”‚   â”‚   â””â”€â”€ data_loader.py  # NumPy ê¸°ë°˜ ê²½ëŸ‰ ë°ì´í„° ë¡œë”
â”‚   â”œâ”€â”€ models/
â”‚   â”‚   â”œâ”€â”€ feature_extractor.py # Feature Extractor (MF) ëª¨ë“ˆ
â”‚   â”‚   â”œâ”€â”€ compression_model.py # Supervised Layer (SL) ëª¨ë“ˆ
â”‚   â”‚   â””â”€â”€ main_model.py        # ì „ì²´ MFBAM ì•„í‚¤í…ì²˜ í†µí•©
â”‚   â””â”€â”€ training/
â”‚       â””â”€â”€ trainer.py      # 2ë‹¨ê³„ í•™ìŠµ íŒŒì´í”„ë¼ì¸ ê´€ë¦¬
â”œâ”€â”€ data/
â”‚   â”œâ”€â”€ original/           # ì›ë³¸ ë°ì´í„°ì…‹ (e.g., .csv)
â”‚   â””â”€â”€ weights/            # í•™ìŠµëœ ëª¨ë¸ ê°€ì¤‘ì¹˜ ì €ì¥ ìœ„ì¹˜
â”œâ”€â”€ scripts/
â”‚   â””â”€â”€ generate_datasets.py # ì˜ˆì œ ë°ì´í„°ì…‹ ìƒì„± ìŠ¤í¬ë¦½íŠ¸
â”œâ”€â”€ run_experiment.py       # ì „ì²´ í•™ìŠµ ë° í‰ê°€ ì‹¤í–‰ ìŠ¤í¬ë¦½íŠ¸
â”œâ”€â”€ requirements.txt        # í•„ìš”í•œ ë¼ì´ë¸ŒëŸ¬ë¦¬ ëª©ë¡
â””â”€â”€ README.md               # í”„ë¡œì íŠ¸ ì„¤ëª… (ì´ íŒŒì¼)
```

## ğŸ› ï¸ ì„¤ì¹˜ ë° ì„¤ì •

1. **ì €ì¥ì†Œ ë³µì œ:**
   ```bash
   git clone https://your-repository-url/BAM_COMPRESSOR.git
   cd BAM_COMPRESSOR
   ```

2. **ê°€ìƒ í™˜ê²½ ìƒì„± ë° í™œì„±í™”:**
   ```bash
   # ê°€ìƒ í™˜ê²½ ìƒì„±
   python -m venv .venv

   # ê°€ìƒ í™˜ê²½ í™œì„±í™” (macOS/Linux)
   source .venv/bin/activate

   # ê°€ìƒ í™˜ê²½ í™œì„±í™” (Windows)
   .\.venv\Scripts\activate
   ```

3. **í•„ìš”í•œ ë¼ì´ë¸ŒëŸ¬ë¦¬ ì„¤ì¹˜:**
   `requirements.txt` íŒŒì¼ì— ì•„ë˜ ë‚´ìš©ì„ ì‘ì„±í•˜ì„¸ìš”.
   ```
   numpy
   pandas
   scikit-learn
   matplotlib
   ```
   ê·¸ë¦¬ê³  ì•„ë˜ ëª…ë ¹ì–´ë¡œ ì„¤ì¹˜í•©ë‹ˆë‹¤.
   ```bash
   pip install -r requirements.txt
   ```

## ğŸš€ ì‚¬ìš© ë°©ë²•

1. **(ìµœì´ˆ 1íšŒ) ì˜ˆì œ ë°ì´í„°ì…‹ ìƒì„±:**
   `run_experiment.py`ë¥¼ ì‹¤í–‰í•˜ê¸° ìœ„í•´ í•„ìš”í•œ `moons_dataset.csv` íŒŒì¼ì„ ìƒì„±í•©ë‹ˆë‹¤.
   ```bash
   python scripts/generate_datasets.py
   ```

2. **ëª¨ë¸ í•™ìŠµ ë° í‰ê°€ ì‹¤í–‰:**
   ì „ì²´ í•™ìŠµ íŒŒì´í”„ë¼ì¸(MF ëª¨ë“ˆ í•™ìŠµ â†’ SL ëª¨ë“ˆ í•™ìŠµ)ì„ ì‹¤í–‰í•˜ê³ , í…ŒìŠ¤íŠ¸ ë°ì´í„°ì— ëŒ€í•œ ì •í™•ë„ í‰ê°€ ë° ê²°ê³¼ ì‹œê°í™”ë¥¼ ìˆ˜í–‰í•©ë‹ˆë‹¤.
   ```bash
   python run_experiment.py
   ```
   í•™ìŠµì´ ì™„ë£Œë˜ë©´, í…ŒìŠ¤íŠ¸ ì •í™•ë„ì™€ í•¨ê»˜ ê²°ì • ê²½ê³„ ë° ì—­ë°©í–¥ ë³µì› íŒ¨í„´ì„ ë³´ì—¬ì£¼ëŠ” `matplotlib` ê·¸ë˜í”„ ì°½ì´ ë‚˜íƒ€ë‚©ë‹ˆë‹¤. í•™ìŠµëœ ê°€ì¤‘ì¹˜ëŠ” `data/weights/` í´ë”ì— ìë™ìœ¼ë¡œ ì €ì¥ë©ë‹ˆë‹¤.

## ğŸ”® í–¥í›„ ê³„íš

- [ ] **í•˜ì´í¼ íŒŒë¼ë¯¸í„° ì¡°ì •**: ê²½ëŸ‰í™”ë¥¼ ìœ„í•œ ì ì ˆí•œ í•˜ì´í¼ íŒŒë¼ë¯¸í„° íƒìƒ‰ 
- [ ] **C/C++ í¬íŒ…**: í•™ìŠµëœ ê°€ì¤‘ì¹˜ë¥¼ ì‚¬ìš©í•˜ì—¬ ì„ë² ë””ë“œ ì‹œìŠ¤í…œìš© ì¶”ë¡  ì—”ì§„ êµ¬í˜„
- [ ] **ëª¨ë¸ ì–‘ìí™”(Quantization)**: `float32` ê°€ì¤‘ì¹˜ë¥¼ `int8`ë¡œ ë³€í™˜í•˜ì—¬ ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ ë° ì—°ì‚° ì†ë„ ìµœì í™”
- [ ] **ì„¤ì • íŒŒì¼ ë„ì…**: í•˜ì´í¼íŒŒë¼ë¯¸í„°ë¥¼ `.py` íŒŒì¼ì´ ì•„ë‹Œ `YAML` íŒŒì¼ë¡œ ê´€ë¦¬í•˜ì—¬ ì‹¤í—˜ ìš©ì´ì„± ì¦ëŒ€

## ğŸ“œ ì°¸ê³  ë¬¸í—Œ

> Rolon-MÃ©rette, D., Rolon-MÃ©rette, T., & Chartier, S. (2023). A multilayered bidirectional associative memory model for learning nonlinear tasks. *Neural Networks, 167*, 244-265.
